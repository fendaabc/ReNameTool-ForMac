# 实施计划

- [x] 1. 修复核心标签页切换逻辑和预览系统

  - 修改 `setupTabSwitching()` 函数，确保每次标签页切换时都调用 `updatePreview()`
  - 修复 `getPreviewName()` 函数中的标签页识别逻辑，使用一致的方法
  - 确保在标签页之间切换时预览立即更新
  - _需求: 1.1, 1.2, 1.3, 2.1, 2.3_

- [x] 2. 修复序列标签页功能

  - [x] 2.1 调试并修复序列预览生成

    - 验证 `getPreviewForSequence()` 函数正确处理文件索引
    - 确保前端和后端之间的序列编号逻辑匹配
    - 用不同的起始数字和位数测试序列预览
    - _需求: 1.1, 1.3_

  - [x] 2.2 修复 executeRename 中的序列标签页规则验证
    - 更新 `executeRename()` 函数以正确识别序列标签页
    - 为序列特定输入（起始、位数、位置）实现正确的验证
    - 确保序列规则数据正确传递给后端
    - _需求: 1.3, 4.2_

- [x] 3. 修复大小写转换标签页功能

  - [x] 3.1 调试并修复大小写转换预览

    - 验证 `getPreviewName()` 函数中的大小写转换逻辑
    - 确保正确检测大小写类型选择
    - 测试所有大小写转换类型（大写、小写、首字母大写）
    - _需求: 1.2, 1.4_

  - [x] 3.2 修复 executeRename 中的大小写转换规则验证
    - 更新 `executeRename()` 函数以正确识别大小写标签页
    - 为大小写转换选择实现正确的验证
    - 确保大小写规则数据正确传递给后端
    - _需求: 1.4, 4.3_

- [x] 4. 修复 executeRename 函数的标签页检测和验证

  - 修改活动标签页检测逻辑，在所有函数中使用一致的方法
  - 更新规则验证逻辑，为每种标签页类型显示适当的错误消息
  - 移除非替换标签页的硬编码"请输入要查找的内容"错误
  - 测试每种标签页类型显示正确的验证错误
  - _需求: 1.5, 4.1, 4.4, 6.1, 6.2, 6.3, 6.4_

- [x] 5. 修复重命名操作后的文件列表管理

  - [x] 5.1 修改重命名后的文件列表处理

    - 更新成功重命名处理，保留文件列表而不是清空它
    - 实现用新名称更新列表中文件名的逻辑
    - 确保文件列表在操作后显示重命名的文件
    - _需求: 3.1, 3.2_

  - [x] 5.2 确保撤销功能与保留的文件列表一起工作
    - 验证成功重命名后撤销按钮变为可用
    - 测试撤销操作与保留的文件列表正确工作
    - 确保在撤销操作期间正确管理文件列表状态
    - _需求: 3.3, 3.4_

- [x] 6. 优化按钮组 UI 和交互逻辑

  - [x] 6.1 移除重做按钮并优化布局

    - 从按钮组 HTML 和 JavaScript 中移除"重做"按钮
    - 更新 CSS 以防止按钮文本换行
    - 确保只保留三个按钮：执行重命名、撤销重命名、全部清空
    - _需求: 5.1, 5.2_

  - [x] 6.2 实现正确的撤销按钮状态管理
    - 确保撤销按钮以禁用/灰色状态开始
    - 更新撤销按钮在成功重命名操作后变为可用
    - 实现撤销执行后再次禁用撤销按钮的逻辑
    - 测试按钮状态转换符合预期行为
    - _需求: 5.3, 5.4, 5.5_

- [x] 7. 添加全面的输入验证和错误处理

  - 实现标签页特定的错误消息逻辑
  - 确保执行按钮的禁用/启用逻辑对所有标签页正确工作
  - 为每个标签页的边缘情况添加正确的错误处理
  - 测试验证错误对用户清晰且可操作
  - _需求: 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 8. 集成测试和验证

  - [x] 8.1 测试每种标签页类型的完整工作流

    - 测试查找/替换标签页：输入验证、预览、执行、撤销
    - 测试序列标签页：输入验证、预览、执行、撤销
    - 测试大小写转换标签页：选择验证、预览、执行、撤销
    - _需求: 1.1, 1.2, 1.3, 1.4, 1.5_

  - [x] 8.2 测试标签页切换行为和预览更新

    - 验证在标签页之间切换时预览立即更新
    - 测试快速标签页切换不会导致错误或不一致状态
    - 确保预览结果没有跨标签页污染
    - _需求: 2.1, 2.2, 2.3, 2.4_

  - [x] 8.3 测试文件列表管理和撤销功能
    - 验证成功重命名操作后文件列表保留
    - 测试整个完整工作流中的撤销按钮状态管理
    - 确保文件列表在重命名操作后显示更新的名称
    - _需求: 3.1, 3.2, 3.3, 3.4_
