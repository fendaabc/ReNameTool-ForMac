<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Status Bar Test</title>
  <link href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    /* æ·»åŠ æµ‹è¯•æ ·å¼ */
    body {
      padding: 20px;
    }
    .test-container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    .test-button {
      margin: 10px 0;
    }
    .test-result {
      margin-top: 20px;
      padding: 15px;
      border-radius: 4px;
      display: none;
    }
    .test-result.pass {
      background-color: #e8f5e9;
      border-left: 4px solid #4caf50;
    }
    .test-result.fail {
      background-color: #ffebee;
      border-left: 4px solid #f44336;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>çŠ¶æ€æ æµ‹è¯•</h1>
    <p>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æµ‹è¯•çŠ¶æ€æ åŠŸèƒ½ï¼š</p>
    
    <button class="test-button" onclick="runLayoutTest()">æµ‹è¯•å¸ƒå±€</button>
    <button class="test-button" onclick="testScrolling()">æµ‹è¯•æ»šåŠ¨</button>
    <button class="test-button" onclick="testLayering()">æµ‹è¯•å±‚çº§</button>
    
    <div id="testResult" class="test-result"></div>
    
    <!-- æµ‹è¯•ç”¨çš„å†…å®¹ -->
    <div style="height: 2000px; margin-top: 20px; padding: 20px; border: 1px dashed #ccc;">
      <p>æ»šåŠ¨æµ‹è¯•åŒºåŸŸ - æ»šåŠ¨é¡µé¢æŸ¥çœ‹çŠ¶æ€æ æ˜¯å¦å›ºå®šåœ¨åº•éƒ¨</p>
    </div>
  </div>

  <!-- å¼•å…¥çŠ¶æ€æ  -->
  <div id="test-status-bar" class="status-bar">
    <div class="status-container">
      <div class="status-left">
        <span class="status-item" title="æ€»æ–‡ä»¶æ•°"><span class="material-icons">description</span><span class="status-text">æ€»æ•°: <strong id="test-status-total">5</strong></span></span>
        <span class="status-item" title="é€‰ä¸­çš„æ–‡ä»¶"><span class="material-icons">check_box</span><span class="status-text">é€‰ä¸­: <strong id="test-status-selected">2</strong></span></span>
        <span class="status-item" title="å·²ä¿®æ”¹çš„æ–‡ä»¶"><span class="material-icons">edit</span><span class="status-text">ä¿®æ”¹: <strong id="test-status-changed">1</strong></span></span>
        <span class="status-item status-warning" title="å†²çªçš„æ–‡ä»¶"><span class="material-icons">warning</span><span class="status-text">å†²çª: <strong id="test-status-conflicts">0</strong></span></span>
        <span class="status-item status-error" title="æ— æ•ˆçš„æ–‡ä»¶"><span class="material-icons">error</span><span class="status-text">æ— æ•ˆ: <strong id="test-status-invalid">0</strong></span></span>
      </div>
      <div class="status-right">
        <span id="test-status-info" class="status-item" title="çŠ¶æ€ä¿¡æ¯"><span class="material-icons">info</span><span class="status-text">æµ‹è¯•çŠ¶æ€</span></span>
      </div>
    </div>
  </div>

  <script>
    function showResult(message, isPass) {
      const resultEl = document.getElementById('testResult');
      resultEl.textContent = message;
      resultEl.className = 'test-result ' + (isPass ? 'pass' : 'fail');
      resultEl.style.display = 'block';
    }

    function runLayoutTest() {
      const statusBar = document.getElementById('test-status-bar');
      const container = statusBar.querySelector('.status-container');
      const items = statusBar.querySelectorAll('.status-item');
      
      // æµ‹è¯•1ï¼šçŠ¶æ€æ æ˜¯å¦å›ºå®šåœ¨åº•éƒ¨
      const rect = statusBar.getBoundingClientRect();
      const isAtBottom = Math.abs(window.innerHeight - rect.bottom) < 5;
      
      // æµ‹è¯•2ï¼šæ˜¯å¦å•è¡Œæ˜¾ç¤º
      const isSingleLine = container.scrollHeight <= statusBar.offsetHeight;
      
      // æµ‹è¯•3ï¼šæ‰€æœ‰é¡¹ç›®æ˜¯å¦å¯¹é½
      let allAligned = true;
      items.forEach(item => {
        const itemRect = item.getBoundingClientRect();
        if (Math.abs(itemRect.top - rect.top) > 5) {
          allAligned = false;
        }
      });
      
      if (isAtBottom && isSingleLine && allAligned) {
        showResult('âœ… æµ‹è¯•é€šè¿‡ï¼šçŠ¶æ€æ å¸ƒå±€æ­£ç¡®', true);
      } else {
        let errors = [];
        if (!isAtBottom) errors.push('çŠ¶æ€æ æœªå›ºå®šåœ¨åº•éƒ¨');
        if (!isSingleLine) errors.push('çŠ¶æ€æ ä¸æ˜¯å•è¡Œæ˜¾ç¤º');
        if (!allAligned) errors.push('çŠ¶æ€é¡¹æœªå¯¹é½');
        showResult('âŒ æµ‹è¯•å¤±è´¥ï¼š' + errors.join('ï¼Œ'), false);
      }
    }

    function testScrolling() {
      const statusBar = document.getElementById('test-status-bar');
      const leftSection = statusBar.querySelector('.status-left');
      
      // æ·»åŠ æ›´å¤šé¡¹ç›®ä»¥æµ‹è¯•æ»šåŠ¨
      for (let i = 0; i < 10; i++) {
        const item = document.createElement('span');
        item.className = 'status-item';
        item.innerHTML = `<span class="material-icons">fiber_manual_record</span><span class="status-text">æµ‹è¯•${i+1}</span>`;
        leftSection.appendChild(item);
      }
      
      // æµ‹è¯•æ»šåŠ¨
      leftSection.scrollLeft = 100;
      showResult('ğŸ”„ å·²æ·»åŠ æµ‹è¯•é¡¹å¹¶å°è¯•æ»šåŠ¨ã€‚è¯·æ£€æŸ¥çŠ¶æ€æ æ˜¯å¦å¯ä»¥æ°´å¹³æ»šåŠ¨ã€‚', true);
    }

    function testLayering() {
      // åˆ›å»ºä¸€ä¸ªè¦†ç›–å±‚æµ‹è¯•z-index
      const overlay = document.createElement('div');
      overlay.style.position = 'fixed';
      overlay.style.top = '0';
      overlay.style.left = '0';
      overlay.style.width = '100%';
      overlay.style.height = '100%';
      overlay.style.background = 'rgba(0,0,0,0.5)';
      overlay.style.zIndex = '999'; // ä½äºçŠ¶æ€æ 
      overlay.style.display = 'flex';
      overlay.style.justifyContent = 'center';
      overlay.style.alignItems = 'center';
      overlay.style.color = 'white';
      overlay.style.fontSize = '24px';
      overlay.textContent = 'çŠ¶æ€æ åº”è¯¥æ˜¾ç¤ºåœ¨æ­¤å±‚ä¹‹ä¸Š';
      
      document.body.appendChild(overlay);
      
      // 3ç§’åç§»é™¤è¦†ç›–å±‚
      setTimeout(() => {
        document.body.removeChild(overlay);
        showResult('ğŸ‘† å±‚çº§æµ‹è¯•å®Œæˆã€‚çŠ¶æ€æ åº”è¯¥å§‹ç»ˆæ˜¾ç¤ºåœ¨å…¶ä»–å†…å®¹ä¹‹ä¸Šã€‚', true);
      }, 3000);
    }
  </script>
</body>
</html>
