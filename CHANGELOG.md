# Changelog

所有显著的变更都将记录在此文件中。

## Unreleased

### 功能升级与详细规则逻辑 (未来规划)

#### 1. 规则分层与配置 (前端 RuleConfig 主面板)
- **常用规则Tab**: 查找替换、前后缀、区段替换、编号排序、大小写转换
- **高级规则Tab/折叠区**: 时间戳插入、字符清理、字段重组、拼音/音译、多条件过滤、预设模板

#### 2. 替换规则详细实现 (前端/后端协作)
- **查找替换 (Find & Replace)**:
  - 前端收集参数 (查找内容、替换内容、正则/普通模式、区分大小写等)，预览Panel实时展示效果。
  - 后端接收参数，批量执行文件名变更，异常处理与结果返回。
- **前后缀替换 (Prefix/Suffix)**:
  - 前端配置前缀/后缀添加或删除，预览Panel展示。
  - 后端实际文件名操作，支持扩展名选项。
- **区段替换 (Slice Replace)**:
  - 前端支持字符区间、定位符号区间、负数索引，参数校验。
  - 后端执行区段替换，保证高性能与安全。
- **编号排序 (Numbering)**:
  - 前端配置起始编号、步长、编号位数、排序方式，预览Panel展示。
  - 后端按排序规则批量编号，事务处理防止重名冲突。
- **其他规则**: 详细规则见前文，前后端均需保证参数一致性、异常处理和预览同步。

#### 3. 文件列表与预览 (FileList, PreviewPanel)
- 文件导入后，前端管理文件列表状态。
- 规则变更后，预览Panel展示新文件名。
- 支持批量撤销/重做，store模块管理数据流。

#### 4. 操作控制与后端通信 (ActionControls, api.js)
- **应用重命名**: 前端收集所有规则参数，调用后端接口批量执行。
- **清空操作**: 前端重置文件列表与规则配置，后端清理缓存。
- **错误与异常**: 前后端均需捕获并友好提示。

### 代码结构优化建议 (技术专家视角)

#### 当前问题
- 前端功能集成度过高，业务逻辑与UI代码混杂，维护和扩展难度大。
- 规则配置、预览、文件管理、后端通信等功能未充分模块化。

#### 推荐拆分方案

##### 前端模块化建议
- `src/components/` 下的组件拆分：`FileImport/`, `FileList/`, `RuleConfig/`, `RuleFindReplace/`, `RuleNumbering/`, `RuleCaseTransform/`, `RuleSliceReplace/`, `RuleAdvanced/`, `PreviewPanel/`, `ActionControls/`。
- `src/utils/` 下的工具类拆分：`renameCore.js` (前端预览用，解耦UI), `validation.js` (参数校验与错误处理), `api.js` (前端与Tauri/Rust后端通信接口)。
- `src/store/`：状态管理 (文件列表、规则队列、撤销栈等)。
- **所有规则配置建议单独组件化**，主面板 `RuleConfig` 负责规则Tab切换和参数收集，单独规则组件负责各自的输入校验与预览逻辑。
- **预览Panel独立组件**，专门处理文件名变化的展示和交互。
- **ActionControls组件**，集中管理所有操作按钮及其事件。
- **前端核心算法 (renameCore.js)**，用于预览和参数验证，避免UI直接操作业务逻辑。
- **api.js**，统一管理与Tauri/Rust后端的通信，便于维护和扩展。
- **store模块**，集中管理应用状态，便于撤销/重做、规则队列等功能实现。

##### 后端 (Rust) 模块拆分建议
- **文件管理模块**: 文件读取、批量导入、路径校验。
- **规则解析与应用模块**: 各类重命名规则的解析与应用 (查找替换、序列化、大小写、区段替换等)。
- **重命名执行模块**: 实际文件系统操作，事务处理，异常捕获。
- **接口通信模块**: 与Tauri前端的消息处理，参数校验，结果返回。

##### 通用建议
- 前后端规则配置与应用逻辑需保持接口一致性，方便未来规则扩展。
- 规则算法应可单元测试，便于验证和维护。
- 所有UI交互、状态变更、后端操作明确分层，避免代码混杂。

### 技术迭代优先级

1. **优先完成前端功能模块拆分**，保证各规则、预览、文件管理、操作区独立，便于维护和扩展。
2. **后端重命名核心逻辑与规则应用模块解耦**，各规则独立实现，接口规范化。
3. **前后端通信接口标准化**，参数校验和异常处理一致，便于未来扩展新规则和功能。
4. **单元测试覆盖关键算法和通信接口**，确保稳定性和可维护性。
5. **持续优化性能，支持大文件夹批量处理和实时预览响应速度。**

### 沟通与迭代建议

- 产品经理与技术团队需保持需求与技术实现同步，及时梳理和优化规则配置与界面逻辑。
- 技术团队优先完成代码结构模块化，降低维护成本，为未来功能扩展做好准备。
- 新功能开发前，评估交互复杂度与数据流，优先保证主流程简洁、易用。
- 所有文档、接口、模块结构需及时更新，便于团队协作和知识传递。

### Added (已完成功能，Git 提交记录)
- 批量导入支持文件夹与类型过滤，空状态友好引导，表格自动切换
- 预览区检测重名与非法字符，冲突高亮并禁用重命名按钮
- 规则预览支持局部高亮，大小写按钮预览，序列/替换规则高亮，预留冲突检测钩子
- Rust后端支持三类批量重命名规则，修复derive冲突
- 基础操作按钮全部完成，tab高亮极简优化，支持重命名撤销与极简tab视觉
- 统一主界面布局与交互，宽屏两栏自适应，Tab激活高亮，规则实时预览，操作按钮归位，整体UI/UX优化

### Changed (已完成变更，Git 提交记录)
- 优化文件导入性能
- 优化右侧面板视觉对齐，统一垂直基线
- 完善操作按钮状态管理，包括初始禁用、流程联动和列表清空后重置
- 前端递归导入性能与健壮性优化：大文件夹导入加载提示、超时保护、异常反馈，导入统计增强
- 前端主界面UI细节优化：按钮高亮色、分区分隔、窄屏自适应修复，修复主操作按钮空白与字体不可见问题
- 缩小tab按钮尺寸，优化圆角和间距，使tab比例更精致紧凑，提升UI极简感
- 全局UI控件圆角、描边、hover、focus、表格分割线等细节极简统一，提升视觉一致性

### Fixed (已修复问题，Git 提交记录)
- 修复某些特殊字符重命名失败的问题
- 修复图标问题；删除无用导入
- 修复文件重命名应用的核心功能
- 修复UI interaction and visual feedback for radio buttons
- 修复后端命令唯一化与多步撤销重做堆栈修复，完善lazy_static依赖
- 修复亮色/极简亮色/暗色主题下所有panel和主区域底色强制统一，修复暗色残留，提升视觉一致性
- 删除撤销重命名功能 (这是一个修复，因为它被删除了)

## v1.0.0 - 2025-08-09

### Added
- 初始版本发布
- 直观的用户界面
- 多种重命名规则（查找替换、序列化、大小写转换）
- 实时预览功能
- 跨平台支持 (macOS, Windows)

### Changed
- [在此处添加 v1.0.0 版本的变更，例如性能优化、UI 调整等]

### Fixed
- [在此处添加 v1.0.0 版本的 Bug 修复]
